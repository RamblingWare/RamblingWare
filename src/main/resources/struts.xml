<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE struts PUBLIC
    "-//Apache Software Foundation//DTD Struts Configuration 2.5//EN"
    "http://struts.apache.org/dtds/struts-2.5.dtd">
<struts>
	
	<!-- / (ROOT) -->
	<package name="root" namespace="/" extends="struts-default">
	
		<interceptors>
			<interceptor name="authentication" class="com.rw.action.interceptor.AuthenticationInterceptor"></interceptor>
			<interceptor name="archive" class="com.rw.action.interceptor.ArchiveInterceptor"></interceptor>
			<interceptor name="header" class="com.rw.action.interceptor.HeaderInterceptor"></interceptor>
			
			<!-- Admin User Authentication -->
			<interceptor-stack name="authStack">
				<interceptor-ref name="header"></interceptor-ref>
				<interceptor-ref name="authentication"></interceptor-ref>
				<interceptor-ref name="defaultStack"></interceptor-ref>
			</interceptor-stack>
			
			<!-- Archive Interceptor -->
			<interceptor-stack name="archiveStack">
				<interceptor-ref name="header"></interceptor-ref>
				<interceptor-ref name="archive"></interceptor-ref>
				<interceptor-ref name="defaultStack"></interceptor-ref>
			</interceptor-stack>
		</interceptors>

		<default-interceptor-ref name="archiveStack"></default-interceptor-ref>

		<global-results>
			<result name="login">/WEB-INF/manage/login.jsp</result>
			<result name="input">/WEB-INF/manage/otp.jsp</result>
			<result name="error">/WEB-INF/error/error.jsp</result>
		</global-results>
		
		<global-exception-mappings>
			<exception-mapping exception="java.lang.Exception" result="error"/>
		</global-exception-mappings>
		
		<!-- ACTIONS -->
		<action name="" class="com.rw.action.HomeAction">
			<result name="success">/WEB-INF/index.jsp</result>
			<result name="error">/WEB-INF/error/error.jsp</result>
			<result name="none">/WEB-INF/error/404.jsp</result>
		</action>
		
		<!-- Static pages -->
		<action name="about">
			<result>/WEB-INF/other/about.jsp</result>
		</action>
		<action name="terms">
			<result>/WEB-INF/other/terms.jsp</result>
		</action>
		<action name="privacy">
			<result>/WEB-INF/other/privacy.jsp</result>
		</action>
		
		<!-- RSS and Search -->
		<action name="rss" class="com.rw.action.RssAction">
			<!-- success already returns the RSS XML -->
			<result name="error">/WEB-INF/error/error.jsp</result>
		</action>
		<action name="search" class="com.rw.action.SearchAction">
			<!-- success already redirects to search website -->
			<result name="input">/WEB-INF/other/search.jsp</result>
			<result name="error">/WEB-INF/error/error.jsp</result>
		</action>
		
		<!-- FORWARD ACTIONS -->
		<action name="blog">
			<result type="redirect">/blog/</result>
		</action>
		<action name="tag">
			<result type="redirect">/tag/</result>
		</action>
		<action name="year">
			<result type="redirect">/year/</result>
		</action>
		<action name="category">
			<result type="redirect">/category/</result>
		</action>
		<action name="author">
			<result type="redirect">/author/</result>
		</action>
		<action name="manage">
			<result type="redirect">/manage/</result>
		</action>
		
		<!-- UNKNOWN ACTIONS ARE 404 ERRORS -->
		<action name="*">
			<interceptor-ref name="defaultStack"></interceptor-ref>
			<result>/WEB-INF/error/404.jsp</result>
		</action>
	</package>
	
	<!-- /BLOG/ -->
	<package name="blog" namespace="/blog" extends="root">

		<default-interceptor-ref name="archiveStack"></default-interceptor-ref>
				
		<action name="" class="com.rw.action.BlogAction">
			<result name="success">/WEB-INF/blog/blog.jsp</result>
			<result name="error">/WEB-INF/blog/blog.jsp</result>
		</action>
		
		<action name="page/*" class="com.rw.action.BlogAction">
			<result name="success">/WEB-INF/blog/blog.jsp</result>
			<result name="error">/WEB-INF/blog/blog.jsp</result>
			<result name="none">/WEB-INF/error/404.jsp</result>
		</action>
		
		<action name="post/*" class="com.rw.action.PostAction">
			<result name="success">/WEB-INF/blog/post.jsp</result>
			<result name="error">/WEB-INF/error/error.jsp</result>
			<result name="none">/WEB-INF/error/404.jsp</result>
		</action>
		
		<action name="*" class="com.rw.action.PostAction">
			<result name="success">/WEB-INF/blog/post.jsp</result>
			<result name="error">/WEB-INF/error/error.jsp</result>
			<result name="none">/WEB-INF/error/404.jsp</result>
		</action>
		
	</package>
	
	<!-- /TAG/ -->
	<package name="tag" namespace="/tag" extends="root">

		<default-interceptor-ref name="archiveStack"></default-interceptor-ref>
		
		<action name="" class="com.rw.action.TagsAction">
			<result name="success">/WEB-INF/tag/tags.jsp</result>
			<result name="error">/WEB-INF/tag/tags.jsp</result>
		</action>
		
		<action name="*/page/*" class="com.rw.action.TagAction">
			<result name="success">/WEB-INF/tag/tag.jsp</result>
			<result name="error">/WEB-INF/error/error.jsp</result>
			<result name="none">/WEB-INF/error/404.jsp</result>
		</action>
		
		<action name="*" class="com.rw.action.TagAction">
			<result name="success">/WEB-INF/tag/tag.jsp</result>
			<result name="error">/WEB-INF/error/error.jsp</result>
			<result name="none">/WEB-INF/error/404.jsp</result>
		</action>
		
	</package>
	
	<!-- /YEAR/ -->
	<package name="year" namespace="/year" extends="root">

		<default-interceptor-ref name="archiveStack"></default-interceptor-ref>
		
		<action name="" class="com.rw.action.YearsAction">
			<result name="success">/WEB-INF/year/years.jsp</result>
			<result name="error">/WEB-INF/year/years.jsp</result>
		</action>
		
		<action name="*/page/*" class="com.rw.action.YearAction">
			<result name="success">/WEB-INF/year/year.jsp</result>
			<result name="error">/WEB-INF/error/error.jsp</result>
			<result name="none">/WEB-INF/error/404.jsp</result>
		</action>
		
		<action name="*" class="com.rw.action.YearAction">
			<result name="success">/WEB-INF/year/year.jsp</result>
			<result name="error">/WEB-INF/error/error.jsp</result>
			<result name="none">/WEB-INF/error/404.jsp</result>
		</action>
		
	</package>
	
	<!-- /CATEGORY/ -->
	<package name="category" namespace="/category" extends="root">

		<default-interceptor-ref name="archiveStack"></default-interceptor-ref>
		
		<action name="" class="com.rw.action.CategoriesAction">
			<result name="success">/WEB-INF/category/categories.jsp</result>
			<result name="error">/WEB-INF/category/categories.jsp</result>
		</action>
		
		<action name="*/page/*" class="com.rw.action.CategoryAction">
			<result name="success">/WEB-INF/category/category.jsp</result>
			<result name="error">/WEB-INF/error/error.jsp</result>
			<result name="none">/WEB-INF/error/404.jsp</result>
		</action>
		
		<action name="*" class="com.rw.action.CategoryAction">
			<result name="success">/WEB-INF/category/category.jsp</result>
			<result name="error">/WEB-INF/error/error.jsp</result>
			<result name="none">/WEB-INF/error/404.jsp</result>
		</action>
		
	</package>
	
	<!-- /AUTHOR/ -->
	<package name="author" namespace="/author" extends="root">

		<default-interceptor-ref name="archiveStack"></default-interceptor-ref>
		
		<action name="" class="com.rw.action.AuthorsAction">
			<result name="success">/WEB-INF/author/authors.jsp</result>
			<result name="error">/WEB-INF/author/authors.jsp</result>
		</action>
		
		<action name="*" class="com.rw.action.AuthorAction">
			<result name="success">/WEB-INF/author/author.jsp</result>
			<result name="error">/WEB-INF/error/error.jsp</result>
			<result name="none">/WEB-INF/error/404.jsp</result>
		</action>
		
	</package>
	
	<!-- /MANAGE/ -->
	<package name="manage" namespace="/manage" extends="root">
	
		<default-interceptor-ref name="authStack"></default-interceptor-ref>
		
		<action name="" class="com.rw.action.manage.MenuAction">
			<result name="success">/WEB-INF/manage/menu.jsp</result>
			<result name="error">/WEB-INF/manage/menu.jsp</result>
		</action>
		
		<action name="menu" class="com.rw.action.manage.MenuAction">
			<result name="success">/WEB-INF/manage/menu.jsp</result>
			<result name="error">/WEB-INF/manage/menu.jsp</result>
		</action>
		
		<action name="test">
			<result>/WEB-INF/manage/test.jsp</result>
		</action>
		
		
		<!-- POST ACTIONS -->
		<action name="posts" class="com.rw.action.manage.post.PostsAction">
			<result name="success">/WEB-INF/manage/post/posts.jsp</result>
			<result name="error">/WEB-INF/manage/post/posts.jsp</result>
		</action>
		
		<action name="posts/page/*" class="com.rw.action.manage.post.PostsAction">
			<result name="success">/WEB-INF/manage/post/posts.jsp</result>
			<result name="error">/WEB-INF/manage/post/posts.jsp</result>
			<result name="none">/WEB-INF/error/404.jsp</result>
		</action>
		
		<action name="newpost" class="com.rw.action.manage.post.NewPostAction">
			<result name="input">/WEB-INF/manage/post/newpost.jsp</result>
			<result name="success" type="chain">
		        <param name="actionName">posts</param>
		    </result>
			<result name="error">/WEB-INF/error/error.jsp</result>
		</action>
		
		<action name="editpost/**" class="com.rw.action.manage.post.EditPostAction">
			<result name="input">/WEB-INF/manage/post/editpost.jsp</result>
			<result name="success" type="chain">
		        <param name="actionName">posts</param>
		    </result>
			<result name="error">/WEB-INF/error/error.jsp</result>
		</action>
		
		<action name="viewpost/**" class="com.rw.action.PostAction">
			<result name="success">/WEB-INF/blog/post.jsp</result>
			<result name="error">/WEB-INF/error/error.jsp</result>
			<result name="none">/WEB-INF/error/404.jsp</result>
		</action>
		
		
		<!-- USER ACTIONS -->
		<action name="users" class="com.rw.action.manage.user.UsersAction">
			<result name="success">/WEB-INF/manage/user/users.jsp</result>
			<result name="error">/WEB-INF/manage/user/users.jsp</result>
		</action>
		
		<action name="users/page/*" class="com.rw.action.manage.user.UsersAction">
			<result name="success">/WEB-INF/manage/user/users.jsp</result>
			<result name="error">/WEB-INF/manage/user/users.jsp</result>
			<result name="none">/WEB-INF/error/404.jsp</result>
		</action>
		
		<action name="newuser" class="com.rw.action.manage.user.NewUserAction">
			<result name="input">/WEB-INF/manage/user/newuser.jsp</result>
			<result name="success" type="chain">
		        <param name="actionName">users</param>
		    </result>
			<result name="error">/WEB-INF/error/error.jsp</result>
		</action>
		
		<action name="edituser/**" class="com.rw.action.manage.user.EditUserAction">
			<result name="input">/WEB-INF/manage/user/edituser.jsp</result>
			<result name="success" type="chain">
		        <param name="actionName">users</param>
		    </result>
			<result name="error">/WEB-INF/error/error.jsp</result>
		</action>
		
		<action name="viewuser/**" class="com.rw.action.AuthorAction">
			<result name="success">/WEB-INF/author/author.jsp</result>
			<result name="error">/WEB-INF/error/error.jsp</result>
			<result name="none">/WEB-INF/error/404.jsp</result>
		</action>
		
		<!-- SETTINGS -->
		<action name="settings">
			<result type="redirect">/manage/settings/profile</result>
		</action>
		<action name="settings/profile" class="com.rw.action.manage.SettingsAction">
			<result name="success">/WEB-INF/manage/settings/profile.jsp</result>
			<result name="error">/WEB-INF/manage/settings/profile.jsp</result>
		</action>
		<action name="settings/account" class="com.rw.action.manage.SettingsAction">
			<result name="success">/WEB-INF/manage/settings/account.jsp</result>
			<result name="error">/WEB-INF/manage/settings/account.jsp</result>
		</action>
		<action name="settings/password" class="com.rw.action.manage.SettingsAction">
			<result name="success">/WEB-INF/manage/settings/password.jsp</result>
			<result name="error">/WEB-INF/manage/settings/password.jsp</result>
		</action>
		<action name="settings/security" class="com.rw.action.manage.SettingsAction">
			<result name="success">/WEB-INF/manage/settings/security.jsp</result>
			<result name="error">/WEB-INF/manage/settings/security.jsp</result>
		</action>
		
		
		<!-- LOGIN / LOGOUT ACTIONS -->
		<action name="login" class="com.rw.action.manage.LoginAction">
			<interceptor-ref name="defaultStack"></interceptor-ref>
			<result name="success" type="chain">
		        <param name="actionName">menu</param>
		    </result>
		    <result name="input">/WEB-INF/manage/otp.jsp</result>
			<result name="error">/WEB-INF/manage/login.jsp</result>
		</action>
		
		<action name="logout" class="com.rw.action.manage.LogoutAction">
			<interceptor-ref name="defaultStack"></interceptor-ref>
			<result name="success" type="chain">
				<param name="actionName">login</param>
			</result>
		</action>
		
		<action name="forgot" class="com.rw.action.manage.ForgotAction">
			<interceptor-ref name="defaultStack"></interceptor-ref>
			<result name="success">/WEB-INF/manage/forgot.jsp</result>
		    <result name="none">/WEB-INF/manage/forgot.jsp</result>
			<result name="error">/WEB-INF/manage/forgot.jsp</result>
		</action>
		
		<!-- UNKNOWN ACTIONS ARE 404 ERRORS -->
		<action name="*">
			<interceptor-ref name="defaultStack"></interceptor-ref>
			<result>/WEB-INF/error/404.jsp</result>
		</action>
		
	</package>
	
	<!-- UNKNOWN NAMESPACE ARE 404 ERRORS -->
	<package name="unknown" namespace="/**" extends="root">
		<!-- UNKNOWN ACTIONS ARE 404 ERRORS -->
		<action name="**">
			<interceptor-ref name="archiveStack"></interceptor-ref>
			<result>/WEB-INF/error/404.jsp</result>
		</action>
	</package>
	
</struts>