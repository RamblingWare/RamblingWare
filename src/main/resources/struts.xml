<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE struts PUBLIC
    "-//Apache Software Foundation//DTD Struts Configuration 2.5//EN"
    "http://struts.apache.org/dtds/struts-2.5.dtd">

<struts>
	
	<!-- / (ROOT) -->
	<package name="root" namespace="/" extends="struts-default">
	
		<interceptors>
			<interceptor name="authentication" class="org.rw.action.interceptor.AuthenticationInterceptor"></interceptor>
			<interceptor name="archive" class="org.rw.action.interceptor.ArchiveInterceptor"></interceptor>
			
			<!-- Admin User Authentication -->
			<interceptor-stack name="authStack">
				<interceptor-ref name="authentication"></interceptor-ref>
				<interceptor-ref name="defaultStack"></interceptor-ref>
			</interceptor-stack>
			
			<!-- Archive Interceptor -->
			<interceptor-stack name="archiveStack">
				<interceptor-ref name="archive"></interceptor-ref>
				<interceptor-ref name="defaultStack"></interceptor-ref>
			</interceptor-stack>
		</interceptors>

		<default-interceptor-ref name="archiveStack"></default-interceptor-ref>

		<global-results>
			<result name="login">/WEB-INF/manage/login.jsp</result>
			<result name="input">/WEB-INF/manage/otp.jsp</result>
			<result name="error">/WEB-INF/error/error.jsp</result>
		</global-results>
		
		<global-exception-mappings>
			<exception-mapping exception="java.lang.Exception" result="error"/>
		</global-exception-mappings>
		
		<!-- ACTIONS -->	
		<action name="" class="org.rw.action.HomeAction">
			<result name="success">/WEB-INF/home.jsp</result>
			<result name="error">/WEB-INF/error/error.jsp</result>
			<result name="none">/WEB-INF/error/404.jsp</result>
		</action>	
		<action name="about">
			<result>/WEB-INF/about.jsp</result>
		</action>
		<action name="terms">
			<result>/WEB-INF/other/terms.jsp</result>
		</action>
		<action name="privacy">
			<result>/WEB-INF/other/privacy.jsp</result>
		</action>
		<action name="rss" class="org.rw.action.RssAction">
			<!-- success already returns the RSS XML -->
			<result name="error">/WEB-INF/error/error.jsp</result>
		</action>
		<action name="search" class="org.rw.action.SearchAction">
			<!-- success already redirects to search website -->
			<result name="error">/WEB-INF/error/error.jsp</result>
		</action>	
		
		<!-- FORWARD ACTIONS -->
		<action name="blog">
			<result type="redirect">/blog/</result>
		</action>
		<action name="tag">
			<result type="redirect">/tag/</result>
		</action>
		<action name="year">
			<result type="redirect">/year/</result>
		</action>
		<action name="category">
			<result type="redirect">/category/</result>
		</action>
		<action name="author">
			<result type="redirect">/author/</result>
		</action>
		<action name="manage">
			<result type="redirect">/manage/</result>
		</action>
		
		<!-- UNKNOWN ACTIONS ARE 404 ERRORS -->
		<action name="*">
			<interceptor-ref name="defaultStack"></interceptor-ref>
			<result>/WEB-INF/error/404.jsp</result>
		</action>
	</package>
	
	<!-- /BLOG/ -->
	<package name="blog" namespace="/blog" extends="root">

		<default-interceptor-ref name="archiveStack"></default-interceptor-ref>
				
		<action name="" class="org.rw.action.BlogAction">
			<result name="success">/WEB-INF/blog/blog.jsp</result>
			<result name="error">/WEB-INF/blog/blog.jsp</result>
		</action>
		
		<action name="page/*" class="org.rw.action.BlogAction">
			<result name="success">/WEB-INF/blog/blog.jsp</result>
			<result name="error">/WEB-INF/blog/blog.jsp</result>
			<result name="none">/WEB-INF/error/404.jsp</result>
		</action>
		
		<action name="post/*" class="org.rw.action.PostAction">
			<result name="success">/WEB-INF/blog/post.jsp</result>
			<result name="error">/WEB-INF/error/error.jsp</result>
			<result name="none">/WEB-INF/error/404.jsp</result>
		</action>
		
		<action name="*" class="org.rw.action.PostAction">
			<result name="success">/WEB-INF/blog/post.jsp</result>
			<result name="error">/WEB-INF/error/error.jsp</result>
			<result name="none">/WEB-INF/error/404.jsp</result>
		</action>
		
	</package>
	
	<!-- /TAG/ -->
	<package name="tag" namespace="/tag" extends="root">

		<default-interceptor-ref name="archiveStack"></default-interceptor-ref>
		
		<action name="" class="org.rw.action.TagsAction">
			<result name="success">/WEB-INF/tag/tags.jsp</result>
			<result name="error">/WEB-INF/tag/tags.jsp</result>
		</action>
		
		<action name="*" class="org.rw.action.TagAction">
			<result name="success">/WEB-INF/tag/tag.jsp</result>
			<result name="error">/WEB-INF/error/error.jsp</result>
		</action>
		
	</package>
	
	<!-- /YEAR/ -->
	<package name="year" namespace="/year" extends="root">

		<default-interceptor-ref name="archiveStack"></default-interceptor-ref>
		
		<action name="" class="org.rw.action.YearsAction">
			<result name="success">/WEB-INF/year/years.jsp</result>
			<result name="error">/WEB-INF/year/years.jsp</result>
		</action>
		
		<action name="*" class="org.rw.action.YearAction">
			<result name="success">/WEB-INF/year/year.jsp</result>
			<result name="error">/WEB-INF/error/error.jsp</result>
		</action>
		
	</package>
	
	<!-- /CATEGORY/ -->
	<package name="category" namespace="/category" extends="root">

		<default-interceptor-ref name="archiveStack"></default-interceptor-ref>
		
		<action name="" class="org.rw.action.CategoriesAction">
			<result name="success">/WEB-INF/category/categories.jsp</result>
			<result name="error">/WEB-INF/category/categories.jsp</result>
		</action>
		
		<action name="*" class="org.rw.action.CategoryAction">
			<result name="success">/WEB-INF/category/category.jsp</result>
			<result name="error">/WEB-INF/error/error.jsp</result>
		</action>
		
	</package>
	
	<!-- /AUTHOR/ -->
	<package name="author" namespace="/author" extends="root">

		<default-interceptor-ref name="archiveStack"></default-interceptor-ref>
		
		<action name="" class="org.rw.action.AuthorsAction">
			<result name="success">/WEB-INF/author/authors.jsp</result>
			<result name="error">/WEB-INF/author/authors.jsp</result>
		</action>
		
		<action name="*" class="org.rw.action.AuthorAction">
			<result name="success">/WEB-INF/author/author.jsp</result>
			<result name="error">/WEB-INF/error/error.jsp</result>
		</action>
		
	</package>
	
	<!-- /MANAGE/ -->
	<package name="manage" namespace="/manage" extends="root">
	
		<default-interceptor-ref name="authStack"></default-interceptor-ref>
		
		<action name="" class="org.rw.action.manage.ManageMenuAction">
			<result name="success">/WEB-INF/manage/menu.jsp</result>
			<result name="error">/WEB-INF/manage/menu.jsp</result>
		</action>
		
		<action name="menu" class="org.rw.action.manage.ManageMenuAction">
			<result name="success">/WEB-INF/manage/menu.jsp</result>
			<result name="error">/WEB-INF/manage/menu.jsp</result>
		</action>
		
		
		<!-- POST ACTIONS -->
		<action name="posts" class="org.rw.action.manage.ViewPostsAction">
			<result name="success">/WEB-INF/manage/viewposts.jsp</result>
			<result name="error">/WEB-INF/manage/viewposts.jsp</result>
		</action>
		
		<action name="posts/page/*" class="org.rw.action.manage.ViewPostsAction">
			<result name="success">/WEB-INF/manage/viewposts.jsp</result>
			<result name="error">/WEB-INF/manage/viewposts.jsp</result>
			<result name="none">/WEB-INF/error/404.jsp</result>
		</action>
		
		<action name="newpost" class="org.rw.action.manage.NewPostAction">
			<result name="input">/WEB-INF/manage/newpost.jsp</result>
			<result name="success" type="chain">
		        <param name="actionName">posts</param>
		    </result>
			<result name="error">/WEB-INF/error/error.jsp</result>
		</action>
		
		<action name="editpost/**" class="org.rw.action.manage.EditPostAction">
			<result name="input">/WEB-INF/manage/editpost.jsp</result>
			<result name="success" type="chain">
		        <param name="actionName">posts</param>
		    </result>
			<result name="error">/WEB-INF/error/error.jsp</result>
		</action>
		
		<action name="viewpost/**" class="org.rw.action.PostAction">
			<result name="success">/WEB-INF/blog/post.jsp</result>
			<result name="error">/WEB-INF/error/error.jsp</result>
			<result name="none">/WEB-INF/error/404.jsp</result>
		</action>
		
		
		<!-- USER ACTIONS -->
		<action name="users" class="org.rw.action.manage.ViewUsersAction">
			<result name="success">/WEB-INF/manage/viewusers.jsp</result>
			<result name="error">/WEB-INF/manage/viewusers.jsp</result>
		</action>
		
		<action name="users/page/*" class="org.rw.action.manage.ViewUsersAction">
			<result name="success">/WEB-INF/manage/viewusers.jsp</result>
			<result name="error">/WEB-INF/manage/viewusers.jsp</result>
			<result name="none">/WEB-INF/error/404.jsp</result>
		</action>
		
		<action name="newuser" class="org.rw.action.manage.NewUserAction">
			<result name="input">/WEB-INF/manage/newuser.jsp</result>
			<result name="success" type="chain">
		        <param name="actionName">users</param>
		    </result>
			<result name="error">/WEB-INF/manage/newuser.jsp</result>
		</action>
		
		<action name="edituser/**" class="org.rw.action.manage.EditUserAction">
			<result name="input">/WEB-INF/manage/edituser.jsp</result>
			<result name="success" type="chain">
		        <param name="actionName">users</param>
		    </result>
			<result name="error">/WEB-INF/error/error.jsp</result>
		</action>
		
		<action name="settings" class="org.rw.action.manage.SettingsAction">
			<result name="success">/WEB-INF/manage/settings.jsp</result>
			<result name="error">/WEB-INF/manage/settings.jsp</result>
		</action>
		
		
		<!-- LOGIN / LOGOUT ACTIONS -->
		<action name="login" class="org.rw.action.manage.LoginAction">
			<interceptor-ref name="defaultStack"></interceptor-ref>
			<result name="success" type="chain">
		        <param name="actionName">menu</param>
		    </result>
		    <result name="input">/WEB-INF/manage/otp.jsp</result>
			<result name="error">/WEB-INF/manage/login.jsp</result>
		</action>
		
		<action name="logout" class="org.rw.action.manage.LogoutAction">
			<interceptor-ref name="defaultStack"></interceptor-ref>
			<result name="success" type="redirect">/</result>
		</action>
		
		<action name="forgot" class="org.rw.action.manage.ForgotAction">
			<interceptor-ref name="defaultStack"></interceptor-ref>
			<result name="success">/WEB-INF/manage/forgot.jsp</result>
		    <result name="none">/WEB-INF/manage/forgot.jsp</result>
			<result name="error">/WEB-INF/manage/forgot.jsp</result>
		</action>
		
		<!-- UNKNOWN ACTIONS ARE 404 ERRORS -->
		<action name="*">
			<interceptor-ref name="defaultStack"></interceptor-ref>
			<result>/WEB-INF/error/404.jsp</result>
		</action>
		
	</package>
	
	<!-- UNKNOWN NAMESPACE ARE 404 ERRORS -->
	<package name="unknown" namespace="/**" extends="root">
		<!-- UNKNOWN ACTIONS ARE 404 ERRORS -->
		<action name="**">
			<interceptor-ref name="defaultStack"></interceptor-ref>
			<result>/WEB-INF/error/404.jsp</result>
		</action>
	</package>
	
</struts>